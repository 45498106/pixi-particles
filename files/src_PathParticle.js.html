<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://yui-s.yahooapis.com/3.8.0/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.ico">
    <script src="https://yui-s.yahooapis.com/3.10.1/build/yui/yui-min.js"></script>
	<title>PixiParticles v1.5.0 API Documentation : src\PathParticle.js</title>  
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><a href="http://github.com/CloudKidStudio/PixiParticles"><img src="../assets/css/logo.png" title="PixiParticles"></a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Documentation for: 1.5.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                		<ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                			<li><a href="#api-modules">Modules</a></li>
                        </ul>
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/cloudkid.AnimatedParticle.html">cloudkid.AnimatedParticle</a></li>
                                <li><a href="../classes/cloudkid.Emitter.html">cloudkid.Emitter</a></li>
                                <li><a href="../classes/cloudkid.Particle.html">cloudkid.Particle</a></li>
                                <li><a href="../classes/cloudkid.PathParticle.html">cloudkid.PathParticle</a></li>
                                <li><a href="../classes/window.Array.prototype.html">window.Array.prototype</a></li>
                                <li><a href="../classes/window.ParticleUtils.html">window.ParticleUtils</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Animated Particle.html">Animated Particle</a></li>
                                <li><a href="../modules/Path Particle.html">Path Particle</a></li>
                                <li><a href="../modules/Pixi Particles.html">Pixi Particles</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
            <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <script>
                        	var name = src\PathParticle.js      
                        </script>
                        <h1 class="file-heading">File:src\PathParticle.js</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        /**
                        *  @module Path Particle
                        *  @namespace cloudkid
                        */
                        (function(cloudkid, undefined) {
                        
                        	&quot;use strict&quot;;
                        
                        	var ParticleUtils = cloudkid.ParticleUtils,
                        		Particle = cloudkid.Particle;
                        
                        	/**
                        	 * An particle that follows a path defined by an algebraic expression, e.g. &quot;sin(x)&quot; or
                        	 * &quot;5x + 3&quot;.
                        	 * To use this class, the particle config must have a &quot;path&quot; string in the
                        	 * &quot;extraData&quot; parameter. This string should have &quot;x&quot; in it to represent movement (from the
                        	 * speed settings of the particle). It may have numbers, parentheses, the four basic
                        	 * operations, and the following Math functions or properties (without the preceding &quot;Math.&quot;):
                        	 * &quot;pow&quot;, &quot;sqrt&quot;, &quot;abs&quot;, &quot;floor&quot;, &quot;round&quot;, &quot;ceil&quot;, &quot;E&quot;, &quot;PI&quot;, &quot;sin&quot;, &quot;cos&quot;, &quot;tan&quot;, &quot;asin&quot;,
                        	 * &quot;acos&quot;, &quot;atan&quot;, &quot;atan2&quot;, &quot;log&quot;.
                        	 * The overall movement of the particle and the expression value become x and y positions for
                        	 * the particle, respectively. The final position is rotated by the spawn rotation/angle of
                        	 * the particle.
                        	*
                        	 * Some example paths:
                        	*
                        	 * 	&quot;sin(x/10) * 20&quot; // A sine wave path.
                        	 * 	&quot;cos(x/100) * 30&quot; // Particles curve counterclockwise (for medium speed/low lifetime particles)
                        	 * 	&quot;pow(x/10, 2) / 2&quot; // Particles curve clockwise (remember, +y is down).
                        	*
                        	 * @class PathParticle
                        	 * @constructor
                        	 * @param {Emitter} emitter The emitter that controls this PathParticle.
                        	 */
                        	var PathParticle = function(emitter)
                        	{
                        		Particle.call(this, emitter);
                        		/**
                        		 * The function representing the path the particle should take.
                        		 * @property {Function} path
                        		 */
                        		this.path = null;
                        		/**
                        		 * The initial rotation in degrees of the particle, because the direction of the path
                        		 * is based on that.
                        		 * @property {Number} initialRotation
                        		 */
                        		this.initialRotation = 0;
                        		/**
                        		 * The initial position of the particle, as all path movement is added to that.
                        		 * @property {PIXI.Point} initialPosition
                        		 */
                        		this.initialPosition = new PIXI.Point();
                        		/**
                        		 * Total single directional movement, due to speed.
                        		 * @property {Number} movement
                        		 */
                        		this.movement = 0;
                        	};
                        
                        	// Reference to the super class
                        	var s = Particle.prototype;
                        	// Reference to the prototype
                        	var p = PathParticle.prototype = Object.create(s);
                        
                        	/**
                        	 * A helper point for math things.
                        	 * @property {Function} helperPoint
                        	 * @private
                        	 * @static
                        	 */
                        	var helperPoint = new PIXI.Point();
                        
                        	/**
                        	 * Initializes the particle for use, based on the properties that have to
                        	 * have been set already on the particle.
                        	 * @method init
                        	 */
                        	p.init = function()
                        	{
                        		//get initial rotation before it is converted to radians
                        		this.initialRotation = this.rotation;
                        		//standard init
                        		this.Particle_init();
                        
                        		//set the path for the particle
                        		this.path = this.extraData.path;
                        		//cancel the normal movement behavior
                        		this._doNormalMovement = !this.path;
                        		//reset movement
                        		this.movement = 0;
                        		//grab position
                        		this.initialPosition.x = this.position.x;
                        		this.initialPosition.y = this.position.y;
                        	};
                        
                        	//a hand picked list of Math functions (and a couple properties) that are allowable.
                        	//they should be used without the preceding &quot;Math.&quot;
                        	var MATH_FUNCS =
                        	[
                        		&quot;pow&quot;,
                        		&quot;sqrt&quot;,
                        		&quot;abs&quot;,
                        		&quot;floor&quot;,
                        		&quot;round&quot;,
                        		&quot;ceil&quot;,
                        		&quot;E&quot;,
                        		&quot;PI&quot;,
                        		&quot;sin&quot;,
                        		&quot;cos&quot;,
                        		&quot;tan&quot;,
                        		&quot;asin&quot;,
                        		&quot;acos&quot;,
                        		&quot;atan&quot;,
                        		&quot;atan2&quot;,
                        		&quot;log&quot;
                        	];
                        	//Allow the 4 basic operations, parentheses and all numbers/decimals, as well
                        	//as &#x27;x&#x27;, for the variable usage.
                        	var WHITELISTER = &quot;[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]&quot;;
                        	//add the math functions to the regex string.
                        	for(var index = MATH_FUNCS.length - 1; index &gt;= 0; --index)
                        	{
                        		WHITELISTER += &quot;|&quot; + MATH_FUNCS[index];
                        	}
                        	//create an actual regular expression object from the string
                        	WHITELISTER = new RegExp(WHITELISTER, &quot;g&quot;);
                        
                        	/**
                        	 * Parses a string into a function for path following.
                        	 * This involves whitelisting the string for safety, inserting &quot;Math.&quot; to math function
                        	 * names, and using eval() to generate a function.
                        	 * @method parsePath
                        	 * @private
                        	 * @static
                        	 * @param {String} pathString The string to parse.
                        	 * @return {Function} The path function - takes x, outputs y.
                        	 */
                        	var parsePath = function(pathString)
                        	{
                        		var rtn;
                        		var matches = pathString.match(WHITELISTER);
                        		for(var i = matches.length - 1; i &gt;= 0; --i)
                        		{
                        			if(MATH_FUNCS.indexOf(matches[i]) &gt;= 0)
                        				matches[i] = &quot;Math.&quot; + matches[i];
                        		}
                        		pathString = matches.join(&quot;&quot;);
                        		eval(&quot;rtn = function(x){ return &quot; + pathString + &quot;; };&quot;);// jshint ignore:line
                        		return rtn;
                        	};
                        
                        	/**
                        	 * Updates the particle.
                        	 * @method update
                        	 * @param {Number} delta Time elapsed since the previous frame, in __seconds__.
                        	 */
                        	p.update = function(delta)
                        	{
                        		var lerp = this.Particle_update(delta);
                        		//if the particle died during the update, then don&#x27;t bother
                        		if(lerp &gt;= 0 &amp;&amp; this.path)
                        		{
                        			//increase linear movement based on speed
                        			var speed = (this.endSpeed - this.startSpeed) * lerp + this.startSpeed;
                        			this.movement += speed * delta;
                        			//set up the helper point for rotation
                        			helperPoint.x = this.movement;
                        			helperPoint.y = this.path(this.movement);
                        			ParticleUtils.rotatePoint(this.initialRotation, helperPoint);
                        			this.position.x = this.initialPosition.x + helperPoint.x;
                        			this.position.y = this.initialPosition.y + helperPoint.y;
                        		}
                        	};
                        
                        	/**
                        	 * Destroys the particle, removing references and preventing future use.
                        	 * @method destroy
                        	 */
                        	p.destroy = function()
                        	{
                        		s.destroy.call(this);
                        	};
                        	
                        	/**
                        	 * Checks over the art that was passed to the Emitter&#x27;s init() function, to do any special
                        	 * modifications to prepare it ahead of time. This just runs Particle.parseArt().
                        	 * @method parseArt
                        	 * @static
                        	 * @param  {Array} art The array of art data. For Particle, it should be an array of Textures.
                        	 *                     Any strings in the array will be converted to Textures via
                        	 *                     Texture.fromImage().
                        	 * @return {Array} The art, after any needed modifications.
                        	 */
                        	PathParticle.parseArt = function(art)
                        	{
                        		return Particle.parseArt(art);
                        	};
                        	
                        	/**
                        	 * Parses extra emitter data to ensure it is set up for this particle class.
                        	 * PathParticle checks for the existence of path data, and parses the path data for use
                        	 * by particle instances.
                        	 * @method parseData
                        	 * @static
                        	 * @param  {Object} extraData The extra data from the particle config.
                        	 * @return {Object} The parsed extra data.
                        	 */
                        	PathParticle.parseData = function(extraData)
                        	{
                        		var output = {};
                        		if(extraData &amp;&amp; extraData.path)
                        		{
                        			try
                        			{
                        				output.path = parsePath(extraData.path);
                        			}
                        			catch(e)
                        			{
                        				if(DEBUG)
                        					console.error(&quot;PathParticle: error in parsing path expression&quot;);
                        				output.path = null;
                        			}
                        		}
                        		else
                        		{
                        			if(DEBUG)
                        				console.error(&quot;PathParticle requires a path string in extraData!&quot;);
                        			output.path = null;
                        		}
                        		return output;
                        	};
                        
                        	cloudkid.PathParticle = PathParticle;
                        
                        }(cloudkid));
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>