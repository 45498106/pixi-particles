/*! Particles 0.0.1 */
!function(){"use strict";var a={},b=Math.PI/180;a.rotatePoint=function(a,c){a*=b;var d=Math.sin(a),e=Math.cos(a),f=c.x*e-c.y*d,g=c.x*d+c.y*e;c.x=f,c.y=g},a.combineRGBComponents=function(a,b,c){return a<<16|b<<8|c},a.hexToRGB=function(a,b){b?b.length=0:b=[],"#"==a.charAt(0)?a=a.substr(1):0===a.indexOf("0x")&&(a=a.substr(2));var c;return 8==a.length&&(c=a.substr(0,2),a=a.substr(2)),b.push(parseInt(a.substr(0,2),16)),b.push(parseInt(a.substr(2,2),16)),b.push(parseInt(a.substr(4,2),16)),c&&b.push(parseInt(c,16)),b},a.generateEase=function(a){var b=a.length,c=1/b,d=function(d){var e,f,g=b*d|0;return e=(d-g*c)*b,f=a[g],f.s+e*(2*(1-e)*(f.cp-f.s)+e*(f.e-f.s))};return d},namespace("cloudkid").ParticleUtils=a,Array.prototype.shuffle||Object.defineProperty(Array.prototype,"shuffle",{enumerable:!1,writable:!1,value:function(){for(var a,b,c=this.length;c;a=Math.floor(Math.random()*c),b=this[--c],this[c]=this[a],this[a]=b);return this}}),Array.prototype.random||Object.defineProperty(Array.prototype,"random",{enumerable:!1,writable:!1,value:function(){return this[Math.floor(Math.random()*this.length)]}})}(),function(){"use strict";var a=cloudkid.ParticleUtils,b=function(a){PIXI.Sprite.call(this,a.particleImages[0]),this.emitter=a,this.anchor.x=this.anchor.y=.5,this.velocity=new PIXI.Point,this.maxLife=0,this.age=0,this.ease=null,this.startAlpha=0,this.endAlpha=0,this.startSpeed=0,this.endSpeed=0,this.startScale=0,this.endScale=0,this.startColor=null,this._sR=0,this._sG=0,this._sB=0,this.endColor=null,this._eR=0,this._eG=0,this._eB=0,this._doAlpha=!1,this._doScale=!1,this._doSpeed=!1,this._doColor=!1,this._oneOverLife=0},c=b.prototype=Object.create(PIXI.Sprite.prototype);c.init=function(){this.age=0,this.velocity.x=this.startSpeed,this.velocity.y=0,GeomUtils.rotatePoint(this.rotation,this.velocity),this.alpha=this.startAlpha,this.scale.x=this.scale.y=this.startScale,this.startColor&&(this._sR=this.startColor[0],this._sG=this.startColor[1],this._sB=this.startColor[2],this.endColor&&(this._eR=this.endColor[0],this._eG=this.endColor[1],this._eB=this.endColor[2])),this._doAlpha=this.startAlpha!=this.endAlpha,this._doSpeed=this.startSpeed!=this.endSpeed,this._doScale=this.startScale!=this.endScale,this._doColor=!!this.endColor,this._oneOverLife=1/this.maxLife,this.tint=a.combineRGBComponents(this._sR,this._sG,this._sB)},this.update=function(b){if(this.age+=b,this.age>=this.maxLife)return void this.emitter.recycle(this);var c=this.age*this._oneOverLife;if(this.ease&&(c=this.ease(c)),this._doAlpha&&(this.alpha=(this.endAlpha-this.startAlpha)*c+this.startAlpha),this._doScale){var d=(this.endScale-this.startScale)*c+this.startScale;this.scale.x=this.scale.y=d}if(this._doSpeed||0!==this.startSpeed){if(this._doSpeed){var e=(this.endSpeed-this.startSpeed)*c+this.startSpeed;this.velocity.normalize(e)}this.position.x+=this.velocity.x*b,this.position.y+=this.velocity.y*b}if(this._doColor){var f=(this._eR-this._sR)*c+this._sR,g=(this._eG-this._sG)*c+this._sG,h=(this._eB-this._sB)*c+this._sB;this.tint=a.combineRGBComponents(f,g,h)}},c.destroy=function(){this.emitter=null,this.velocity=null,this.startColor=this.endColor=null,this.ease=null},namespace("cloudkid").Particle=b}(),function(){"use strict";var a=cloudkid.ParticleUtils,b=function(a,b,c){this.particleImages=null,this.startAlpha=1,this.endAlpha=1,this.startSpeed=0,this.endSpeed=0,this.startScale=1,this.endScale=1,this.startColor=null,this.endColor=null,this.minAngle=0,this.maxAngle=0,this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this.frequency=0,this.spawnPos=null,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this.parent=a,this.addAtBack=!1,this.emit=!0,this._spawnTimer=0,this._activeParticles=[],this._pool=[],b&&c&&this.init(b,c)},c=b.prototype={};c.init=function(b,c){if(this.cleanup(),this.particleImages=b instanceof PIXI.Texture?[b]:b,this.particleImages.length>1)for(var d=this.particleImages.length-1;d>0;--d)if(this.particleImages[d].baseTexture!=this.particleImages[d-1].baseTexture){Debug.warn("CloudKid Particles: using particle textures from different images may hinder performance in WebGL");break}c.alpha?(this.startAlpha=c.alpha.start,this.endAlpha=c.alpha.end):this.startAlpha=this.endAlpha=1,c.speed?(this.startSpeed=c.speed.start,this.endSpeed=c.speed.end):this.startSpeed=this.endSpeed=0,c.scale?(this.startScale=c.scale.start,this.endScale=c.scale.end):this.startScale=this.endScale=1,c.color&&(this.startColor=ColorUtils.hexToRGB(c.color.start),this.endColor=c.color.start!=c.color.end?ColorUtils.hexToRGB(c.color.end):null),c.angle?(this.minAngle=c.angle.min,this.maxAngle=c.angle.max):this.minAngle=this.maxAngle=0,this.minLifetime=c.lifetime.min,this.maxLifetime=c.lifetime.max,this.frequency=c.frequency,this.addAtBack=!!c.addAtBack,c.ease&&(this.customEase="function"==typeof c.ease?c.ease:a.generateEase(c.ease)),this.rotation=0,this.ownerPos=new PIXI.Point,this.spawnPos=new PIXI.Point(c.pos.x,c.pos.y),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=!0},c.recycle=function(a){var b=this._activeParticles.indexOf(a);b<this._activeParticles.length-1&&(this._activeParticles[b]=this._activeParticles[this._activeParticles.length-1]),this._activeParticles.pop(),this._pool.push(a),this.particle.parent&&this.particle.parent.removeChild(this.particle)},c.rotate=function(b){if(this.rotation!=b){var c=b-this.rotation;this.rotation=b,a.rotatePoint(c,this.spawnPos),this._posChanged=!0}},c.updateSpawnPos=function(a,b){this._posChanged=!0,this.spawnPos.x=a,this.spawnPos.y=b},c.updateOwnerPos=function(a,b){this._posChanged=!0,this.ownerPos.x=a,this.ownerPos.y=b},c.resetPositionTracking=function(){this._prevPosIsValid=!1},c.update=function(a){for(var b=this._activeParticles.length-1;b>=0;--b)this._activeParticles[b].update(a);var c,d;this._prevPosIsValid&&(c=this._prevEmitterPos.x,d=this._prevEmitterPos.y);var e=this.ownerPos.x+this.spawnPos.x,f=this.ownerPos.y+this.spawnPos.y;if(this.emit)for(this._spawnTimer-=a;this._spawnTimer<=0;){var g;if(g=this.minLifetime==this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer<g){var h=_pool.length?_pool.pop():new Particle(this);if(this.particleImages.length>1&&h.setTexture(this.particleImages.random()),h.startAlpha=this.startAlpha,h.endAlpha=this.endAlpha,h.startSpeed=this.startSpeed,h.endSpeed=this.endSpeed,h.startScale=this.startScale,h.endScale=this.endScale,h.startColor=this.startColor,h.endColor=this.endColor,h.maxLife=g,h.rotation=this.minAngle==this.maxAngle?this.minAngle+this.rotation:Math.random()*(this.maxAngle-this.minAngle)+this.minAngle+this.rotation,this._prevPosIsValid&&this._posChanged){var i=1+this._spawnTimer/a;h.x=(e-c)*i+c,h.y=(f-d)*i+d}else h.x=e,h.y=f;h.init(),h.update(-this._spawnTimer),this.addAtBack?this.parent.addChildAt(h,0):this.parent.addChild(h),this._activeParticles.push(h)}this._spawnTimer+=this.frequency}this._posChanged&&(this._prevEmitterPos.x=e,this._prevEmitterPos.y=f,this._prevPosIsValid=!0,this._posChanged=!1)},c.cleanup=function(){for(var a=this._activeParticles.length-1;a>=0;--a)this.recycle(this._activeParticles[a])},c.destroy=function(){super.destroy(),this.cleanup();for(var a=this._pool.length-1;a>=0;--a)this._pool[a].destroy();this._pool=null,this._activeParticles=null,this.parent=null,this.particleImages=null,this.spawnPos=null,this.ownerPos=null,this.startColor=null,this.endColor=null,this.customEase=null},namespace("cloudkid").Emitter=b}();