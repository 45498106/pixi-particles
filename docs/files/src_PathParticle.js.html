<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/PathParticle.js - pixi-particles</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-skin-sam">
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <h1 class="brand" style="padding: 10px 16px 10px; height: 20px; line-height: 20px; margin-left: 0;">
	    <img alt="pixi-particles" src="https://raw.githubusercontent.com/pixijs/pixi-particles-editor/master/deploy/assets/images/icon.png" style="max-height: 65%;" title="pixi-particles">
            pixi-particles
        </h1>
	<div class="nav">
            <li class="divider-vertical"></li>
            <li>
                <p class="navbar-text">
                    API Docs for Version: <b>1.6.1</b>
                </p>
            </li>
        </div>
        <form class="navbar-form pull-right" style="line-height: 40px; height: 40px;">
            <input style="margin-top: 0;" type="text" class="search-query" placeholder="Search for classes/modules..." data-obj='["classes/PIXI.particles.AnimatedParticle", "classes/PIXI.particles.Emitter", "classes/PIXI.particles.Particle", "classes/PIXI.particles.ParticleUtils", "classes/PIXI.particles.PathParticle", "classes/window.Array", "modules/Animated Particle", "modules/Path Particle", "modules/Pixi Particles"]'>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span3">
	    <div>
	        <h3>APIs</h3>
	        <div id="sidebar">
	            <ul id="main-nav" class="nav nav-tabs" style="margin-bottom:0;">
	                <li class="active"><a href="#classes" data-toggle="tab">Classes</a></li>
	                <li><a href="#modules" data-toggle="tab">Modules</a></li>
	            </ul>
	    
	            <div id="api-tabview-filter">
	                <input type="search" placeholder="Type to filter APIs">
	            </div>
	    
	            <div class="tab-content" style="border: 1px solid #DDD; border-top:0;">
	                <div class="tab-pane active" id="classes">
	                    <ul id="api-classes" class="nav nav-list">
	                            <li><a href="../classes/PIXI.particles.AnimatedParticle.html">PIXI.particles.AnimatedParticle</a></li>
	                            <li><a href="../classes/PIXI.particles.Emitter.html">PIXI.particles.Emitter</a></li>
	                            <li><a href="../classes/PIXI.particles.Particle.html">PIXI.particles.Particle</a></li>
	                            <li><a href="../classes/PIXI.particles.ParticleUtils.html">PIXI.particles.ParticleUtils</a></li>
	                            <li><a href="../classes/PIXI.particles.PathParticle.html">PIXI.particles.PathParticle</a></li>
	                            <li><a href="../classes/window.Array.html">window.Array</a></li>
	                    </ul>
	                </div>
	    
	                <div class="tab-pane" id="modules">
	                    <ul id="api-modules" class="nav nav-list">
	                            <li><a href="../modules/Animated Particle.html">Animated Particle</a></li>
	                            <li><a href="../modules/Path Particle.html">Path Particle</a></li>
	                            <li><a href="../modules/Pixi Particles.html">Pixi Particles</a></li>
	                    </ul>
	                </div>
	            </div>
	        </div>
	    </div>
        </div>
        <div class="span9">
                <form id="options-form" class="form-inline pull-right">
                    Show:
                    <label for="api-show-inherited" class="checkbox">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected" class="checkbox">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private" class="checkbox">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated" class="checkbox">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </form>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<div class="page-header">
    <h1>src/PathParticle.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
/**
*  @module Path Particle
*  @namespace PIXI.particles
*/
(function(PIXI, undefined) {

	&quot;use strict&quot;;

	var ParticleUtils = PIXI.particles.ParticleUtils,
		Particle = PIXI.particles.Particle;

	/**
	 * An particle that follows a path defined by an algebraic expression, e.g. &quot;sin(x)&quot; or
	 * &quot;5x + 3&quot;.
	 * To use this class, the particle config must have a &quot;path&quot; string in the
	 * &quot;extraData&quot; parameter. This string should have &quot;x&quot; in it to represent movement (from the
	 * speed settings of the particle). It may have numbers, parentheses, the four basic
	 * operations, and the following Math functions or properties (without the preceding &quot;Math.&quot;):
	 * &quot;pow&quot;, &quot;sqrt&quot;, &quot;abs&quot;, &quot;floor&quot;, &quot;round&quot;, &quot;ceil&quot;, &quot;E&quot;, &quot;PI&quot;, &quot;sin&quot;, &quot;cos&quot;, &quot;tan&quot;, &quot;asin&quot;,
	 * &quot;acos&quot;, &quot;atan&quot;, &quot;atan2&quot;, &quot;log&quot;.
	 * The overall movement of the particle and the expression value become x and y positions for
	 * the particle, respectively. The final position is rotated by the spawn rotation/angle of
	 * the particle.
	*
	 * Some example paths:
	*
	 * 	&quot;sin(x/10) * 20&quot; // A sine wave path.
	 * 	&quot;cos(x/100) * 30&quot; // Particles curve counterclockwise (for medium speed/low lifetime particles)
	 * 	&quot;pow(x/10, 2) / 2&quot; // Particles curve clockwise (remember, +y is down).
	*
	 * @class PathParticle
	 * @constructor
	 * @param {Emitter} emitter The emitter that controls this PathParticle.
	 */
	var PathParticle = function(emitter)
	{
		Particle.call(this, emitter);
		/**
		 * The function representing the path the particle should take.
		 * @property {Function} path
		 */
		this.path = null;
		/**
		 * The initial rotation in degrees of the particle, because the direction of the path
		 * is based on that.
		 * @property {Number} initialRotation
		 */
		this.initialRotation = 0;
		/**
		 * The initial position of the particle, as all path movement is added to that.
		 * @property {PIXI.Point} initialPosition
		 */
		this.initialPosition = new PIXI.Point();
		/**
		 * Total single directional movement, due to speed.
		 * @property {Number} movement
		 */
		this.movement = 0;
	};

	// Reference to the super class
	var s = Particle.prototype;
	// Reference to the prototype
	var p = PathParticle.prototype = Object.create(s);

	/**
	 * A helper point for math things.
	 * @property {Function} helperPoint
	 * @private
	 * @static
	 */
	var helperPoint = new PIXI.Point();

	/**
	 * Initializes the particle for use, based on the properties that have to
	 * have been set already on the particle.
	 * @method init
	 */
	p.init = function()
	{
		//get initial rotation before it is converted to radians
		this.initialRotation = this.rotation;
		//standard init
		this.Particle_init();

		//set the path for the particle
		this.path = this.extraData.path;
		//cancel the normal movement behavior
		this._doNormalMovement = !this.path;
		//reset movement
		this.movement = 0;
		//grab position
		this.initialPosition.x = this.position.x;
		this.initialPosition.y = this.position.y;
	};

	//a hand picked list of Math functions (and a couple properties) that are allowable.
	//they should be used without the preceding &quot;Math.&quot;
	var MATH_FUNCS =
	[
		&quot;pow&quot;,
		&quot;sqrt&quot;,
		&quot;abs&quot;,
		&quot;floor&quot;,
		&quot;round&quot;,
		&quot;ceil&quot;,
		&quot;E&quot;,
		&quot;PI&quot;,
		&quot;sin&quot;,
		&quot;cos&quot;,
		&quot;tan&quot;,
		&quot;asin&quot;,
		&quot;acos&quot;,
		&quot;atan&quot;,
		&quot;atan2&quot;,
		&quot;log&quot;
	];
	//Allow the 4 basic operations, parentheses and all numbers/decimals, as well
	//as &#x27;x&#x27;, for the variable usage.
	var WHITELISTER = &quot;[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]&quot;;
	//add the math functions to the regex string.
	for(var index = MATH_FUNCS.length - 1; index &gt;= 0; --index)
	{
		WHITELISTER += &quot;|&quot; + MATH_FUNCS[index];
	}
	//create an actual regular expression object from the string
	WHITELISTER = new RegExp(WHITELISTER, &quot;g&quot;);

	/**
	 * Parses a string into a function for path following.
	 * This involves whitelisting the string for safety, inserting &quot;Math.&quot; to math function
	 * names, and using eval() to generate a function.
	 * @method parsePath
	 * @private
	 * @static
	 * @param {String} pathString The string to parse.
	 * @return {Function} The path function - takes x, outputs y.
	 */
	var parsePath = function(pathString)
	{
		var rtn;
		var matches = pathString.match(WHITELISTER);
		for(var i = matches.length - 1; i &gt;= 0; --i)
		{
			if(MATH_FUNCS.indexOf(matches[i]) &gt;= 0)
				matches[i] = &quot;Math.&quot; + matches[i];
		}
		pathString = matches.join(&quot;&quot;);
		eval(&quot;rtn = function(x){ return &quot; + pathString + &quot;; };&quot;);// jshint ignore:line
		return rtn;
	};

	/**
	 * Updates the particle.
	 * @method update
	 * @param {Number} delta Time elapsed since the previous frame, in __seconds__.
	 */
	p.update = function(delta)
	{
		var lerp = this.Particle_update(delta);
		//if the particle died during the update, then don&#x27;t bother
		if(lerp &gt;= 0 &amp;&amp; this.path)
		{
			//increase linear movement based on speed
			var speed = (this.endSpeed - this.startSpeed) * lerp + this.startSpeed;
			this.movement += speed * delta;
			//set up the helper point for rotation
			helperPoint.x = this.movement;
			helperPoint.y = this.path(this.movement);
			ParticleUtils.rotatePoint(this.initialRotation, helperPoint);
			this.position.x = this.initialPosition.x + helperPoint.x;
			this.position.y = this.initialPosition.y + helperPoint.y;
		}
	};

	/**
	 * Destroys the particle, removing references and preventing future use.
	 * @method destroy
	 */
	p.destroy = function()
	{
		s.destroy.call(this);
	};
	
	/**
	 * Checks over the art that was passed to the Emitter&#x27;s init() function, to do any special
	 * modifications to prepare it ahead of time. This just runs Particle.parseArt().
	 * @method parseArt
	 * @static
	 * @param  {Array} art The array of art data. For Particle, it should be an array of Textures.
	 *                     Any strings in the array will be converted to Textures via
	 *                     Texture.fromImage().
	 * @return {Array} The art, after any needed modifications.
	 */
	PathParticle.parseArt = function(art)
	{
		return Particle.parseArt(art);
	};
	
	/**
	 * Parses extra emitter data to ensure it is set up for this particle class.
	 * PathParticle checks for the existence of path data, and parses the path data for use
	 * by particle instances.
	 * @method parseData
	 * @static
	 * @param  {Object} extraData The extra data from the particle config.
	 * @return {Object} The parsed extra data.
	 */
	PathParticle.parseData = function(extraData)
	{
		var output = {};
		if(extraData &amp;&amp; extraData.path)
		{
			try
			{
				output.path = parsePath(extraData.path);
			}
			catch(e)
			{
				if(DEBUG)
					console.error(&quot;PathParticle: error in parsing path expression&quot;);
				output.path = null;
			}
		}
		else
		{
			if(DEBUG)
				console.error(&quot;PathParticle requires a path string in extraData!&quot;);
			output.path = null;
		}
		return output;
	};

	PIXI.particles.PathParticle = PathParticle;

}(PIXI));
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script>prettyPrint();</script>
</body>
</html>
